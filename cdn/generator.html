<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>CDN Generator</title>
	<style>
		body {
			font-family: Arial, sans-serif;
		}

		#modules {
			line-height: 150%;
			margin-bottom: 20px;
		}

		#modules label {
			display: inline-block;
			width: 60px;
		}

		#output {
			font-family: "Courier New", sans-serif;
			font-size: 16px;
			padding: 15px;
			background: #EEE;
			border: 1px solid #111;
			width: 450px;
			overflow: auto;
		}
	</style>
</head>
<body>
	<div id="modules">
		<h2>Base modules</h2>
		<form id="modules_base">
			<input value="core" type="checkbox" class="cbx_module" name="modules/core/fw.core.min.js" id="cbx_core" checked="checked" disabled="disabled"/>
			<label for="cbx_core">Core</label>

			<input value="dom" type="checkbox" class="cbx_module" name="modules/dom/fw.dom.min.js" id="cbx_dom"/>
			<label for="cbx_dom">DOM</label>

			<input value="css" type="checkbox" class="cbx_module" name="modules/css/fw.css.min.js" id="cbx_css"/>
			<label for="cbx_css">CSS</label>

			<br/>

			<input value="data" type="checkbox" class="cbx_module" name="modules/data/fw.data.min.js" id="cbx_data"/>
			<label for="cbx_data">Data</label>

			<input value="events" type="checkbox" class="cbx_module" name="modules/events/fw.events.min.js" id="cbx_events"/>
			<label for="cbx_events">Events</label>

			<input value="ajax" type="checkbox" class="cbx_module" name="modules/ajax/fw.ajax.min.js" id="cbx_ajax"/>
			<label for="cbx_ajax">Ajax</label>
		</form>

		<h2>Extra modules</h2>
		<form id="modules_extra">
			<input value="animate" type="checkbox" class="cbx_module" name="modules/animate/fw.animate.min.js" id="cbx_animate"/>
			<label for="cbx_animate">Animate</label>
		</form>
	</div>

	<div id="output"></div>

	<script src="../dist/framewreck.min.js"></script>
	<script>
		var basePath 	= '//cdn.jsdelivr.net/g/framewreck';
		var modules 	= '';

		F('.cbx_module').on('change', updateModules);

		function updateModules() {
			var module;

			// BASE MODULES
			var modules_base = F('form#modules_base').serialize();
			var modules_base_arr = [F('#cbx_core').attr('name')];
			for(module in modules_base) {
				if(modules_base.hasOwnProperty(module) && modules_base[module] && module != F('#cbx_core').attr('name')) {
					modules_base_arr.push(module);
				}
			}

			// EXTRA MODULES
			var modules_extra = F('form#modules_extra').serialize();
			var modules_extra_arr = [];
			for(module in modules_extra) {
				if(modules_extra.hasOwnProperty(module) && modules_extra[module]) {
					if(module == F('#cbx_animate').attr('name')) {
						// add dependencies
						if(F('#cbx_css, #cbx_events, #cbx_data').checked().some(isFalse)) {
							F('#cbx_css, #cbx_events, #cbx_data').checked(true);
							updateModules(); return;
						}
					}

					modules_extra_arr.push(module);
				}
			}

			if(modules_base_arr.length == F('#modules_base').find('.cbx_module').length && !modules_extra_arr.length) {
				modules_base_arr = [];
			}

			var modules_all = modules_base_arr.concat(modules_extra_arr);

			if(modules_all.length) {
				modules = '('+ modules_all.join("+")  +')';
			} else {
				modules = '';
			}

			url = basePath + modules;

			output.innerHTML = url;
		}

		function isFalse(item) {
			return item == false;
		}

		updateModules();
	</script>
</body>
</html>