F.ext({parse:function(ctx,r,S){return S=String.prototype,S.parseObject=function(a,b,c,d,e){return this[r="replace"](e=RegExp("{{#(?: *)(\\w+)(?: *)}}([\\s\\S]*?){{\\/(?: *)\\1(?: *)}}","g"),function(f,g,h){if(c="",a[g])for(d in a[g])c+=h.parseTag(b,"ctx['"+g+"']["+d+"]",a),c=c.parseIf(b,"ctx."+g+"["+d+"].",a),c.match(e)&&(c=c.parseObject(a[g][d],b+1));return c})},S.parseIf=function(n,V,ctx,m,v,e){return this[r](RegExp("(?:{{#{"+n+"}if(?: *))(.*)(?: *)}}([\\s\\S]*?)(?:{{\\/{"+n+"}if}})","g"),function(p,c,d,f){m=c.match(/(^!|^not) */),v=V,m&&(c=c.replace(m[0],""),v="!"+v);try{f=eval(v+c)}catch(e){f=0}return d.match(e=/{{(#+)else}}[\s\S]*/)?d[r](f?e:/[\s\S]*\{{(#+)else}}/,""):f?d:""})},S.parseTag=function(n,V,ctx){return this[r](RegExp("{+\\{#{"+n+"} *(?!else)([A-Za-z0-9_.]+) *}}+","g"),function(p,$1,f){try{f=eval(!V.big||~$1.indexOf(".")?V+"['"+$1.replace(/\./g,"']['")+"']":V)}catch(e){}return f=f?f.big?f:"string"!=typeof f[$1]?p:f[$1]:"","{"==p[2]?new Option(f)[F.H]:f})},F(this[0][F.H].parseObject(ctx,1).parseTag(0,"ctx",ctx).parseIf(1,"ctx.",ctx)[r](/{%(.*)%}/g,function(p,$1){return eval($1)}).trim())}});