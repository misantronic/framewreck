F.ext({parse:function(ctx,r,S){return S=String.prototype,S.parseObject=function(a,b,c,d){return this[r="replace"](RegExp("{{#{"+b+"}each(?: *)(\\w+)(?: *)}}([\\s\\S]*?){{\\/{"+b+"}each}}","g"),function(e,f,g){if(c="",a[f])for(d in a[f])c+=g.parseTag(b,"ctx['"+f+"']["+d+"]",a),c=c.parseIf(b,"ctx."+f+"["+d+"].",a),c.match(RegExp("{{#{"+(b+1)+"}each","g"))&&(c=c.parseObject(a[f][d],b+1));return c})},S.parseIf=function(n,V,ctx,m,v,e){return this[r](RegExp("(?:{{#{"+n+"}if(?: *))(.*)(?: *)}}([\\s\\S]*?)(?:{{\\/{"+n+"}if}})","g"),function(p,c,d,f){m=c.match(/(^!|^not) */),v=V,m&&(c=c.replace(m[0],""),v="!"+v);try{f=eval(v+c)}catch(e){f=0}return d.match(e=/{{(#+)else}}[\s\S]*/)?d[r](f?e:/[\s\S]*\{{(#+)else}}/,""):f?d:""})},S.parseTag=function(n,V,ctx){return this[r](RegExp("{+\\{#{"+n+"} *(?!else)([A-Za-z0-9_.]+) *}}+","g"),function(p,$1,f){try{f=eval(!V.big||~$1.indexOf(".")?V+"['"+$1.replace(/\./g,"']['")+"']":V)}catch(e){}return f=f?f.big?f:f[$1]:"","{"==p[2]?new Option(f)[F.H]:f})},F(this.html().parseObject(ctx,1).parseTag(0,"ctx",ctx).parseIf(1,"ctx.",ctx)[r](/{%(.*)%}/g,function(p,$1){return eval($1)}).trim())}});