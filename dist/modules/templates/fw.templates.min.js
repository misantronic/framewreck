F.ext({parse:function(ctx,r,e1,e2){function parseObject(a,b,c,d,e){return a[r](RegExp("{{#{"+c+"}each(?: *)(\\w+)(?: *)}}([\\s\\S]*?){{\\/{"+c+"}each}}","g"),function(a,f,g){return d="",b[f]&&b[f].forEach(function(a,h){d+=g[r](parseTag(c),function(a,c){return e=b[f][h].big?b[f][h]:b[f][h][c],escapeHTML(a,e)}),d=d[r](parseIf(c),function(a,c,d){return d.match(e1)?d.replace(b[f][h][c]?e1:e2,""):b[f][h][c]?d:""}),d.match(RegExp("{{#{"+(c+1)+"}each","g"))&&(d=parseObject(d,b[f][h],c+1))}),d})}function escapeHTML(a,b){return"{{{"==a.substr(0,3)&&"}}}"==a.slice(-3)?new Option(b)[F.H]:b}function parseTag(a){return RegExp("{+\\{#{"+a+"} *(?!else)(\\w+) *}}+","g")}function parseJS(){return RegExp("{% *(.*) *%}","g")}function parseIf(a){return RegExp("(?:{{#{"+a+"}if(?: *))(\\w+)(?: *)}}([\\s\\S]*?)(?:{{\\/{"+a+"}if}})","g")}return r="replace",e1=/{{(#+)else}}[\s\S]*/,e2=/[\s\S]*\{{(#+)else}}/,F(parseObject(this.html(),ctx,1)[r](parseTag(0),function(a,b){return escapeHTML(a,ctx[b])})[r](parseIf(1),function(a,b,c){return c.replace(ctx[b]?e1:e2,"")})[r](parseJS(),function(p,$1){return eval($1)}).trim())}});