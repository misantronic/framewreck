F.ext({parse:function(ctx,r){var S=String.prototype,map=[],i=0,s=this[0][F.H][r="replace"](/(?:{{#if(?: *))(.*)(?: *)}}/g,function(a,b){return map[i]=b,"{##"+i++ +"##}"});for(i=map[F.L];i--;)s=s[r](RegExp("{##"+i+"##}([\\s\\S]*?){{\\/if}}","g"),"{##"+i+"##}$1{##/"+i+"##}");return S.parseObject=function(a,b,c){return this[r](c=RegExp("{{(?: *)(\\w+)(?: *)}}([\\s\\S]*?){{\\/(?: *)\\1(?: *)}}","g"),function(d,e,f){if(b="",a[e])for(i in a[e])b+=f.parseTag("ctx['"+e+"']["+i+"]",a),b=b.parseIf("ctx."+e+"["+i+"].",a),b.match(c)&&(b=b.parseObject(a[e][i]));return b})},S.parseIf=function(V,ctx,m,v,e){return this[r](/{##(\d)##}([\s\S]*){##\/\1##}/g,function(p,a,b,f){a=map[+a],m=a.match(/(^!|^not) */),v=V,m&&(a=a.replace(m[0],""),v="!"+v);try{f=eval(v+a)}catch(e){f=0}return b.match(e=/{{(#+)else}}[\s\S]*/)?b[r](f?e:/[\s\S]*\{{(#+)else}}/,""):f?b:""})},S.parseTag=function(V,ctx,t){return this[r](RegExp("{+\\{ *([A-Za-z0-9_.]+) *}}+","g"),function(p,$1,f){try{f=eval(!V.big||$1.match(t=/\./g)?V+"['"+$1.replace(t,"']['")+"']":V)}catch(e){}return f=f?f.big?f:"string"!=typeof f[$1]?p:f[$1]:"","{"==p[2]?new Option(f)[F.H]:f})},F(s.parseObject(ctx,1).parseTag("ctx",ctx).parseIf("ctx.",ctx)[r](/{%(.*)%}/g,function(p,$1){return eval($1)}).trim())}});